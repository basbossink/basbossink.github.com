<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>PS for .NET devs part 2: Comparing the PowerShell language to C# - Nothing to see here</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In my previous posts in this series I discussed why you should care about PowerShell and I pointed to some resources to help you get started with PowerShell. This post will describe the syntax of the PowerShell language by comparing it with the syntax of C#. Recently the PowerShell language specification was released under the community promise, so if you want to learn everything there is to know about the PowerShell language look it up."><meta property="og:image" content><meta property="og:title" content="PS for .NET devs part 2: Comparing the PowerShell language to C#"><meta property="og:description" content="In my previous posts in this series I discussed why you should care about PowerShell and I pointed to some resources to help you get started with PowerShell. This post will describe the syntax of the PowerShell language by comparing it with the syntax of C#. Recently the PowerShell language specification was released under the community promise, so if you want to learn everything there is to know about the PowerShell language look it up."><meta property="og:type" content="article"><meta property="og:url" content="http://basbossink.github.io/posts/2011-11-14-ps4.netdevs-2-powershell-syntax/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-11-14T00:00:00+00:00"><meta property="article:modified_time" content="2011-11-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PS for .NET devs part 2: Comparing the PowerShell language to C#"><meta name=twitter:description content="In my previous posts in this series I discussed why you should care about PowerShell and I pointed to some resources to help you get started with PowerShell. This post will describe the syntax of the PowerShell language by comparing it with the syntax of C#. Recently the PowerShell language specification was released under the community promise, so if you want to learn everything there is to know about the PowerShell language look it up."><script src=http://basbossink.github.io/js/feather.min.js></script>
<link href=http://basbossink.github.io/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://basbossink.github.io/css/main.40ca3a860425083862b7ebd55447caec5c4384573f0cb098b8d06a91e8dace2e.css><link id=darkModeStyle rel=stylesheet type=text/css href=http://basbossink.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css><link rel=stylesheet type=text/css href=http://basbossink.github.io/css/overrides.c755da9dccb0cb7240fb81a9a5f7b0962c285b8f6c9bcce5b2e7fa691de6a58b.css></head><body><div class=content><header><div class=main><a href=http://basbossink.github.io/>Nothing to see here</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/projects>Projects</a>
<a href=/about>About</a></nav></header><main><article><div class=title><h1 class=title>PS for .NET devs part 2: Comparing the PowerShell language to C#</h1><div class=meta>Posted on Nov 14, 2011</div></div><section class=body><p>In my previous posts in this series I discussed
<a href=/2011-06-19/ps4.netdevs-0-what-and-why/ title="PS for .NET devs part 0: PowerShell what is it and why should I care?">why you should care about PowerShell</a> and I pointed to some
resources to help you <a href=/2011-06-22-ps4.netdev-1-getting-started-with-powershell/ title="PS for .NET devs part 1: Getting started with PowerShell">get started with PowerShell</a>. This post will
describe the syntax of the <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> language by comparing it
with the syntax of C#. <a href=http://blogs.msdn.com/b/powershell/archive/2011/04/16/powershell-language-now-licensed-under-the-community-promise.aspx title="Powershell Language specification announcement">Recently</a> the
<a href="http://www.microsoft.com/download/en/details.aspx?id=9706" title="Windows PowerShell Language Specification Version 2.0">PowerShell language specification</a> was released under the
community promise, so if you want to learn everything there is to know
about the <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> language look <a href="http://www.microsoft.com/download/en/details.aspx?id=9706" title="Windows PowerShell Language Specification Version 2.0">it</a> up.</p><p>To summarize this post: When translating a piece of C# code to
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> take what you would normally write in C#, remove all
the explicit typing and add a few <code>$</code>&rsquo;s here and there. The comparison
is mostly presented in a tabular form showing the C# syntax in the
first column and the equivalent <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> syntax in the second,
followed with a description of the particular language construct in
the last column. Enjoy.</p><h3 id=comments>Comments</h3><table><thead><tr><th>C#</th><th>PowerShell</th><th>Description</th></tr></thead><tbody><tr><td><code>//</code></td><td><code>#</code></td><td>single line</td></tr><tr><td><code>/* ... */</code></td><td><code>&lt;# ... #></code></td><td>multi line</td></tr><tr><td><code>///</code></td><td></td><td>single line documentation comments</td></tr></tbody></table><h4 id=comment-documentation-keywords>Comment documentation keywords</h4><p><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> is also blessed with comment-based help but
because it does not have any formating keywords and does not focus on
types, a lot of the corresponding keywords have no equivalent in the
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> column. <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> supports more keywords than
the ones listed below for the entire story please use
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>&rsquo;s built in help: <code>help about_Comment_Based_Help</code> or the <a href=http://technet.microsoft.com/en-us/library/dd819489.aspx title="About Comment Based Help">online documentation</a>:</p><table><thead><tr><th>C#</th><th>PowerShell</th><th>Description</th></tr></thead><tbody><tr><td><code>&lt;c></code></td><td></td><td>Set text in a code-like font</td></tr><tr><td><code>&lt;code></code></td><td></td><td>Set one or more lines of source code or program output</td></tr><tr><td><code>&lt;example></code></td><td><code>.EXAMPLE</code></td><td>Indicate an example</td></tr><tr><td><code>&lt;exception></code></td><td></td><td>Identify the exceptions a method can throw</td></tr><tr><td><code>&lt;include></code></td><td><code>.EXTERNALHELP</code></td><td>Includes XML from an external file</td></tr><tr><td><code>&lt;list></code></td><td></td><td>Create a list or table</td></tr><tr><td><code>&lt;para></code></td><td></td><td>Permit structure to be added to text</td></tr><tr><td><code>&lt;param></code></td><td><code>.PARAMETER</code></td><td>Describe a parameter for a method or constructor</td></tr><tr><td><code>&lt;paramref></code></td><td></td><td>Identify that a word is a parameter name</td></tr><tr><td><code>&lt;permission></code></td><td></td><td>Document the security accessibility of a member</td></tr><tr><td><code>&lt;remarks></code></td><td></td><td>Describe a type</td></tr><tr><td><code>&lt;returns></code></td><td><code>.OUTPUTS</code></td><td>Describe the return value of a method</td></tr><tr><td><code>&lt;see></code></td><td><code>.LINK</code></td><td>Specify a link</td></tr><tr><td><code>&lt;seealso></code></td><td><code>.LINK</code></td><td>Generate a See Also entry</td></tr><tr><td><code>&lt;summary></code></td><td><code>.SYNOPSIS</code></td><td>Describe a member of a type</td></tr><tr><td><code>&lt;value></code></td><td></td><td>Describe a property</td></tr><tr><td></td><td><code>.NOTES</code></td><td>Additional information about the function or script</td></tr><tr><td></td><td><code>.DESCRIPTION</code></td><td>A detailed description of the function or script</td></tr><tr><td></td><td><code>.INPUTS</code></td><td>The inputs that can be piped to the function or script</td></tr></tbody></table><h3 id=literals>Literals</h3><p>Literals are the same as in C# with a few minor differences:</p><ul><li>In <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> the backtick (<code>`</code>) is the escape character:
<code>PS>"Quotes need to be escaped `""</code></li><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> does not have <code>char</code> literals to create one you have
to use a cast: <code>[char]"a"</code>.</li><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> multi-line strings also begin with the <code>@"</code> it
however has to be followed by a new line, furthermore the end mark
is a <code>"@</code> which has to be put at the beginning of the line.</li><li>Array literals are created using the array operator <code>,</code>. So
<code>"Fred","Barney"</code> creates on array containing 2 strings.</li><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> distinguishes single quoted <code>''</code> and double quoted
<code>""</code> string literals the former causes the string to be interpreted
verbatim while the later is subject to string interpolation. Here&rsquo;s
an example:</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;<span style=color:#f1fa8c>&#34;my $PSCulture is dutch&#34;</span>
</span></span><span style=display:flex><span>My <span style=color:#8be9fd;font-style:italic>nl-NL</span> is dutch.
</span></span><span style=display:flex><span>PS&gt;<span style=color:#f1fa8c>&#39;my $PSCulture is dutch&#39;</span>
</span></span><span style=display:flex><span>My <span style=color:#8be9fd;font-style:italic>$PSCulture</span> is dutch.
</span></span></code></pre></td></tr></table></div></div><ul><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> supports <code>HashTable</code> literals of the form: <code>@{ &lt;name> = &lt;value>; [&lt;name> = &lt;value> ] ... }</code>. Below you can see that
<code>HashTable</code> literals can be split across multiple lines in which
case the semicolons (<code>;</code>) after the name-value pair can be omitted
leaving a nice and readable <code>HashTable</code> behind.</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$table</span> = @{ a=37; b=42;}
</span></span><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$ttable</span> = @{
</span></span><span style=display:flex><span>&gt;&gt;a=37
</span></span><span style=display:flex><span>&gt;&gt;b=43
</span></span><span style=display:flex><span>&gt;&gt;}
</span></span><span style=display:flex><span>&gt;&gt;
</span></span><span style=display:flex><span>PS&gt;
</span></span></code></pre></td></tr></table></div></div><h3 id=variables>Variables</h3><p>In <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> variable declarations don&rsquo;t require explicit
typing, they do however have to be prefixed with a <code>$</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$now</span> = [DateTime]::UtcNow
</span></span><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$message</span> = <span style=color:#f1fa8c>&#39;hello&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Being a .NET developer you&rsquo;re probably wondering how you can create
objects in <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>. There is no <code>new</code> keyword but there is a
<a href=http://technet.microsoft.com/en-us/library/dd315334.aspx title=New-Object><code>New-Object</code></a> <a href="http://msdn.microsoft.com/en-EN/library/ms714395(v=VS.85).aspx" title="Cmdlet overview">Cmdlet</a>. It can for example be used like
this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$dateofbirth</span> = <span style=color:#8be9fd;font-style:italic>New-Object</span> DateTime -ArgumentList 1972,7,12
</span></span><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$feeds</span> = <span style=color:#8be9fd;font-style:italic>new-object</span> -Com Microsoft.FeedsManager
</span></span><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$feeds</span>.IsSubscribed(<span style=color:#f1fa8c>&#34;http://basbossink.github.com/atom.xml&#34;</span>)
</span></span><span style=display:flex><span>True
</span></span></code></pre></td></tr></table></div></div><p>To have a little bit more brevity in the shell you don&rsquo;t have to
specify the entire full name of the type. <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> has some
built-in type accelerators so for instance in the case of
<code>System.DateTime</code> you can leave of the <code>System</code> namespace part. See
<a href=http://stackoverflow.com/questions/1145312/ title="StackOverflow question about type accelerators">this</a> <a href=http://stackoverflow.com title=StackOverflow>StackOverflow</a> <a href=http://stackoverflow.com/questions/1145312/ title="StackOverflow question about type accelerators">question</a> for some extra
references about the subject. As you can see the <a href=http://technet.microsoft.com/en-us/library/dd315334.aspx title=New-Object><code>New-Object</code></a>
<a href="http://msdn.microsoft.com/en-EN/library/ms714395(v=VS.85).aspx" title="Cmdlet overview">Cmdlet</a> can also be used to create COM objects see <code>help New-Object</code> for more details or look at the
<a href=http://technet.microsoft.com/en-us/library/dd315334.aspx title=New-Object>online documentation</a>.</p><h3 id=operators>Operators</h3><p>The arithmetic and assignment operators are the same for C# and
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> the differences start with the comparison operators
the familiar <code>></code> and friends are replaced with a <code>-</code> followed by an
abbreviation for the comparison. This was done to keep the meaning
of <code>></code> for redirection as all system administrators now it from dos and
POSIX shells.</p><p>Apart from this table above there are a couple of extra operators that
have no C# equivalent:</p><ul><li>Redirection operators:
<code>>, >>, 2>, 2>&1</code></li><li>Comma operator: <code>,</code>
Creates an array.</li><li>Split and Join operators: <code>-split,-join</code>
To divide and combine substrings<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;1,2,3 -join <span style=color:#f1fa8c>&#39;*&#39;</span>
</span></span><span style=display:flex><span>1*2*3
</span></span><span style=display:flex><span>PS&gt;<span style=color:#8be9fd;font-style:italic>$env:PATH</span> -split <span style=color:#f1fa8c>&#39;;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>%</span>SystemRoot%\system32\WindowsPowerShell\v1.0\
</span></span><span style=display:flex><span>⋮ 
</span></span></code></pre></td></tr></table></div></div></li><li>Call operator: <code>&</code>
Run a command, script, or script block.<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;&amp; <span style=color:#f1fa8c>&#39;C:\Program Files (x86)\GNU\GnuPG\sha256sum.exe&#39;</span> test.iso
</span></span></code></pre></td></tr></table></div></div></li><li>Dot sourcing operator: <code>.</code>
Runs a script so that the variables, functions defined in the script
are part of the calling scope.</li><li>Static member operator: <code>::</code>
Used to call static method or retrieve
static properties of a .NET Framework class.<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>[Math]::Sin(([Math]::PI)/2)
</span></span></code></pre></td></tr></table></div></div></li><li>Range operator: <code>..</code>
Represents the sequential integers within the given
upper and lower boundary.<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>PS&gt;1..10 -join <span style=color:#f1fa8c>&#39;,&#39;</span>
</span></span><span style=display:flex><span>1,2,3,4,5,6,7,8,9,10
</span></span></code></pre></td></tr></table></div></div></li><li>Format operator: <code>-f</code>
The following two pieces of code are equivalent (starting with C#):<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>Math.PI.ToString(<span style=color:#f1fa8c>&#34;{0:0.00}&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><hr><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#f1fa8c>&#34;{0:0.00}&#34;</span> <span style=color:#ff79c6>-f</span> [Math]::PI
</span></span></code></pre></td></tr></table></div></div></li><li>Subexpression operator: <code>$()</code>
Returns the result of one or more statements.
Very handy in string interpolation like<div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>
</span></span><span style=display:flex><span>PS&gt;<span style=color:#f1fa8c>&#34;This machine has </span>$([Environment]::ProcessorCount)<span style=color:#f1fa8c> cpu&#39;s&#34;</span>
</span></span><span style=display:flex><span>This machine has 2 cpu&#39;s
</span></span></code></pre></td></tr></table></div></div></li><li>Array subexpression operator <code>@()</code>
Returns the result of one or more statements as an array.</li></ul><h3 id=selection-statements>Selection Statements</h3><p><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> supports the <code>if-else</code> and <code>switch</code> statements.
The <code>if-else</code> differs only in the fact that <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> has a
<code>elseif</code> keyword where C# uses <code>else if</code>.</p><p>In <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> the <code>switch</code> statement has more functionality
compared to C# since it supports switching on regular expressions and
wildcards when the values supplied let themselves be converted to
strings. Again use <code>help about_Switch</code> (or look <a href=http://technet.microsoft.com/en-us/library/dd347715.aspx title="About Switch">here</a>).</p><h3 id=iteration-statements>Iteration Statements</h3><p>Even though it&rsquo;s not explicitly mentioned in the table above
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> also supports the familiar <code>break</code> and <code>continue</code> keywords. See <code>help about_break</code> (or <a href=http://technet.microsoft.com/en-us/library/dd315285.aspx title="About Break">here</a>) and <code>help about_continue</code> (or
<a href=http://technet.microsoft.com/en-us/library/dd347559.aspx title="About Continue">here</a>) for details. When using <a href=http://technet.microsoft.com/en-us/library/dd347608.aspx title=ForEach-Object><code>ForEach-Object</code></a> the
<a href=http://technet.microsoft.com/en-us/library/dd347675.aspx title="About Automatic Variables">Automatic Variable</a> <code>$_</code> represents the current item, see <a href=http://technet.microsoft.com/en-us/library/dd347733.aspx title="About Foreach"><code>help about_Foreach</code></a> for details.</p><h3 id=exception-handling>Exception Handling</h3><p>Since version 2 <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> supports the C#
<a href=http://technet.microsoft.com/en-us/library/dd315350.aspx title="About Try, Catch, Finally"><code>try-catch-finally</code></a> syntax besides the earlier introduced
<a href=http://technet.microsoft.com/en-us/library/dd347548.aspx title="About Trap"><code>trap</code></a> keyword, which can be viewed as a <code>catch</code> block with an
implicit <code>try</code> for the surrounding scope. <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> also
supports <a href=http://technet.microsoft.com/en-us/library/dd819510.aspx title="About Throw"><code>throw</code></a>, the difference being that any expression
can be <a href=http://technet.microsoft.com/en-us/library/dd819510.aspx title="About Throw"><code>throw</code></a>n. The expression in the <a href=http://technet.microsoft.com/en-us/library/dd819510.aspx title="About Throw"><code>throw</code></a>
syntax is optional, this reminds me a bit of the <a href=http://www.perl.org title="The Perl Programming Language">Perl</a>
<a href=http://perldoc.perl.org/functions/die.html title="The Perl die Function"><code>die</code></a> function.</p><h3 id=functions>Functions</h3><p>Functions in <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> are quite a different beast when compared
to C#. At first glance there are many similarities, both languages
support positional parameters, keyword parameters and optional
parameters. The extra benefit in the case of <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> in my
opinion is, the ability to use pipeline parameters. Lets look at an
example:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>function</span> <span style=color:#8be9fd;font-style:italic>Get-SumOfSquares</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>begin</span> { <span style=color:#8be9fd;font-style:italic>$result</span> = 0 }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>process</span> { <span style=color:#8be9fd;font-style:italic>$result</span> += <span style=color:#8be9fd;font-style:italic>$_</span> * <span style=color:#8be9fd;font-style:italic>$_</span> }
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>end</span> { <span style=color:#8be9fd;font-style:italic>$result</span> }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>1..25 |
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>ForEach-Object</span> { <span style=color:#8be9fd;font-style:italic>Get-Random</span> -Maximum 100 } |
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>Get-SumOfSquares</span>
</span></span></code></pre></td></tr></table></div></div><p>Here you can see the filtering of the pipeline input in a way that
reminds me of <a href=http://en.wikipedia.org/wiki/AWK title="The Awk programming language">Awk</a>, the <a href=http://www.gnu.org/s/gawk/manual/gawk.html#BEGIN_002fEND title="GNU Awk Begin End syntax"><code>begin</code> and <code>end</code> syntax</a>
specifically. The <code>begin</code> and <code>end</code> blocks mean exactly what you think
they mean. The <code>process</code> block gets called by <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> for each
value received from the pipeline. Where <code>$_</code> has the value of the
<a href=http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.current.aspx title="Current property"><code>Current</code></a> value as in the value of the <a href=http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.current.aspx title="Current property"><code>Current</code></a>
property when using the <a href=http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx title="IEnumerator interface"><code>IEnumerator</code></a> interface. Since
version 2 a lot of functionality was added to provide extra
functionality to functions, the so called <a href=http://technet.microsoft.com/en-us/library/dd315326.aspx title="About Functions Advanced">Advanced Functions</a> see
<code>help about_Functions_Advanced</code> for details this includes stuff like
declarative parameter validation, specifying parameter sets, aliases
and a brief help message for parameters. Elaborating on the earlier
<code>Get-SumOfSquares</code> example a full blown implementation could look
something like this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>function</span> <span style=color:#8be9fd;font-style:italic>Get-SumOfSquares</span> {
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>Param</span>(
</span></span><span style=display:flex><span>        [<span style=color:#ff79c6>Parameter</span>(<span style=color:#ff79c6>Mandatory</span>=<span style=color:#8be9fd;font-style:italic>$true</span>,
</span></span><span style=display:flex><span>                   <span style=color:#ff79c6>ValueFromPipeline</span>=<span style=color:#8be9fd;font-style:italic>$true</span>,
</span></span><span style=display:flex><span>                   <span style=color:#ff79c6>HelpMessage</span>=<span style=color:#f1fa8c>&#34;An array of integers.&#34;</span> )]
</span></span><span style=display:flex><span>        [<span style=color:#ff79c6>Alias</span>(<span style=color:#f1fa8c>&#34;IN&#34;</span>)]
</span></span><span style=display:flex><span>        [int[]]
</span></span><span style=display:flex><span>        <span style=color:#8be9fd;font-style:italic>$InputObject</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>$result</span> = 0
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>$InputObject</span> | <span style=color:#8be9fd;font-style:italic>ForEach-Object</span> {
</span></span><span style=display:flex><span>        <span style=color:#8be9fd;font-style:italic>$result</span> += <span style=color:#8be9fd;font-style:italic>$_</span> * <span style=color:#8be9fd;font-style:italic>$_</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>$result</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>After pasting this in the <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> console an example usage
might look like the screenshot below.</p><p><img src=GetSumOfSquaresSample.png alt="Get-SumOfSquares example interaction" title="Get-SumOfSquares example interaction"></p><h3 id=epilogue>Epilogue</h3><p>This is my brief summary of the syntactic differences between C# and
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>. I hope this can help you with coming to grips with
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>. Next time we&rsquo;ll look at how easy it is to work with
XML in <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> and munge a large <a href=http://msdn.microsoft.com/en-us/library/wea2sca5.aspx title=MSBuild>MSBuild</a> file with a
small script.</p><h5 id=references>References</h5><ul><li><a href=/2011-06-19/ps4.netdevs-0-what-and-why/>PS for .NET devs part 0: PowerShell what is it and why should I care?</a></li><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419>Scripting with Windows PowerShell</a></li><li><a href=/2011-06-22-ps4.netdev-1-getting-started-with-powershell/>PS for .NET devs part 1: Getting started with PowerShell</a></li><li><a href=http://blogs.msdn.com/b/powershell/archive/2011/04/16/powershell-language-now-licensed-under-the-community-promise.aspx>Powershell Language specification announcement</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd315285.aspx>About Break</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd819489.aspx>About Comment Based Help</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347559.aspx>About Continue</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347715.aspx>About Switch</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd819510.aspx>About Throw</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347548.aspx>About Trap</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd315350.aspx>About Try, Catch, Finally</a></li><li><a href=http://www.perl.org>The Perl Programming Language</a></li><li><a href=http://perldoc.perl.org/functions/die.html>The Perl die Function</a></li><li><a href=http://msdn.microsoft.com/en-us/library/wea2sca5.aspx>MSBuild</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd315334.aspx>New-Object</a></li><li><a href="http://msdn.microsoft.com/en-EN/library/ms714395(v=VS.85).aspx">Cmdlet overview</a></li><li><a href=http://stackoverflow.com/questions/1145312/>StackOverflow question about type accelerators</a></li><li><a href=http://stackoverflow.com>StackOverflow</a></li><li><a href=http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.current.aspx>Current property</a></li><li><a href=http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx>IEnumerator interface</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd315326.aspx>About Functions Advanced</a></li><li><a href=http://en.wikipedia.org/wiki/AWK>The Awk programming language</a></li><li><a href=http://www.gnu.org/s/gawk/manual/gawk.html#BEGIN_002fEND>GNU Awk Begin End syntax</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347733.aspx>About Foreach</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347608.aspx>ForEach-Object</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd347675.aspx>About Automatic Variables</a></li></ul></section><div class=post-tags></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/basbossink/ title=GitHub><i data-feather=github></i></a><a class=soc href=https://twitter.com/basbossink/ title=Twitter><i data-feather=twitter></i></a></div><div class=footer-info>2022 © Bas Bossink | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>