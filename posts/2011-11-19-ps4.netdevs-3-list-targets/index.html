<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>PS for .NET devs part 3: List Targets in your MSBuild file - Nothing to see here</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The project I&rsquo;m currently working on, started more than five years ago and has quite a large MSBuild file to perform all the build automation for the project. A while back I found myself struggling to remember the name of a specific build Target that I don&rsquo;t use very often. Since such a large XML file is not as readable as one would hope I couldn&rsquo;t find what I was looking for fast enough."><meta property="og:image" content><meta property="og:title" content="PS for .NET devs part 3: List Targets in your MSBuild file"><meta property="og:description" content="The project I&rsquo;m currently working on, started more than five years ago and has quite a large MSBuild file to perform all the build automation for the project. A while back I found myself struggling to remember the name of a specific build Target that I don&rsquo;t use very often. Since such a large XML file is not as readable as one would hope I couldn&rsquo;t find what I was looking for fast enough."><meta property="og:type" content="article"><meta property="og:url" content="https://basbossink.github.io/posts/2011-11-19-ps4.netdevs-3-list-targets/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-11-19T00:00:00+00:00"><meta property="article:modified_time" content="2011-11-19T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="PS for .NET devs part 3: List Targets in your MSBuild file"><meta name=twitter:description content="The project I&rsquo;m currently working on, started more than five years ago and has quite a large MSBuild file to perform all the build automation for the project. A while back I found myself struggling to remember the name of a specific build Target that I don&rsquo;t use very often. Since such a large XML file is not as readable as one would hope I couldn&rsquo;t find what I was looking for fast enough."><script src=https://basbossink.github.io/js/feather.min.js></script>
<link href=https://basbossink.github.io/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://basbossink.github.io/css/main.40ca3a860425083862b7ebd55447caec5c4384573f0cb098b8d06a91e8dace2e.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://basbossink.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css><link rel=stylesheet type=text/css href=https://basbossink.github.io/css/overrides.c755da9dccb0cb7240fb81a9a5f7b0962c285b8f6c9bcce5b2e7fa691de6a58b.css></head><body><div class=content><header><div class=main><a href=https://basbossink.github.io/>Nothing to see here</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/projects>Projects</a>
<a href=/about>About</a></nav></header><main><article><div class=title><h1 class=title>PS for .NET devs part 3: List Targets in your MSBuild file</h1><div class=meta>Posted on Nov 19, 2011</div></div><section class=body><p>The project I&rsquo;m currently working on, started more than five years ago
and has quite a large <a href="http://msdn.microsoft.com/en-us/library/ms171452(v=vs.90).aspx" title="MSBuild Overview">MSBuild</a> file to perform all the build
automation for the project. A while back I found myself struggling to
remember the name of a specific build <a href="http://msdn.microsoft.com/en-us/library/ms171462(v=VS.100).aspx" title="MSBuild Targets"><code>Target</code></a> that I don&rsquo;t use
very often. Since such a large XML file is not as readable as one
would hope I couldn&rsquo;t find what I was looking for fast enough. Since I
know <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> has good XML support I opened the
<a href=http://technet.microsoft.com/en-us/library/dd315244.aspx title="PowerShell ISE">PowerShell Integrated Scripting environment</a> and experimented a
bit to see how hard it would be to list all the <a href="http://msdn.microsoft.com/en-us/library/ms171462(v=VS.100).aspx" title="MSBuild Targets"><code>Target</code></a>s in
the <a href="http://msdn.microsoft.com/en-us/library/ms171452(v=vs.90).aspx" title="MSBuild Overview">MSBuild</a> file using <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>.</p><p>To give you an idea what an <a href="http://msdn.microsoft.com/en-us/library/ms171452(v=vs.90).aspx" title="MSBuild Overview">MSBuild</a> file looks like here is a
little snippet from the <a href=http://www.openwrap.org/ title=OpenWrap>OpenWrap</a> source:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; ?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;Project</span> <span style=color:#50fa7b>xmlns=</span><span style=color:#f1fa8c>&#34;http://schemas.microsoft.com/developer/msbuild/2003&#34;</span> <span style=color:#50fa7b>DefaultTargets=</span><span style=color:#f1fa8c>&#34;OpenWrap-Package&#34;</span> <span style=color:#50fa7b>ToolsVersion=</span><span style=color:#f1fa8c>&#34;3.5&#34;</span><span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;PropertyGroup&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;Root&gt;</span>$(MSBuildProjectDirectory)\..<span style=color:#ff79c6>&lt;/Root&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;Configuration</span> <span style=color:#50fa7b>Condition=</span><span style=color:#f1fa8c>&#34;&#39;$(Configuration)&#39; == &#39;&#39;&#34;</span><span style=color:#ff79c6>&gt;</span>Debug<span style=color:#ff79c6>&lt;/Configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;PackageName</span> <span style=color:#50fa7b>Condition=</span><span style=color:#f1fa8c>&#34;&#39;$(PackageName)&#39; == &#39;&#39;&#34;</span><span style=color:#ff79c6>&gt;</span>OpenWrap<span style=color:#ff79c6>&lt;/PackageName&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;OpenWrap-DescriptorPath</span> <span style=color:#50fa7b>Condition=</span><span style=color:#f1fa8c>&#34;&#39;$(OpenWrap-DescriptorPath)&#39; == &#39;&#39;&#34;</span><span style=color:#ff79c6>&gt;</span>$(Root)\$(PackageName).wrapdesc<span style=color:#ff79c6>&lt;/OpenWrap-DescriptorPath&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;OpenWrap-BuildTasksDirectory</span> <span style=color:#50fa7b>Condition=</span><span style=color:#f1fa8c>&#34;&#39;$(OpenWrap-BuildTasksDirectory)&#39; == &#39;&#39;&#34;</span><span style=color:#ff79c6>&gt;</span>$(Root)\wraps\openwrap\build<span style=color:#ff79c6>&lt;/OpenWrap-BuildTasksDirectory&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;/PropertyGroup&gt;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;ItemGroup&gt;</span> 
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;WrapBinary</span> <span style=color:#50fa7b>Include=</span><span style=color:#f1fa8c>&#34;$(Root)\src\**\*.csproj&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;/ItemGroup&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;Target</span> <span style=color:#50fa7b>Name=</span><span style=color:#f1fa8c>&#34;Clean&#34;</span><span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;Delete</span> <span style=color:#50fa7b>Files=</span><span style=color:#f1fa8c>&#34;$(Root)\scratch\build\**\*.*&#34;</span> <span style=color:#50fa7b>ContinueOnError=</span><span style=color:#f1fa8c>&#34;true&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;Delete</span> <span style=color:#50fa7b>Files=</span><span style=color:#f1fa8c>&#34;$(Root)\scratch\package\**\*.*&#34;</span> <span style=color:#50fa7b>ContinueOnError=</span><span style=color:#f1fa8c>&#34;true&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;RemoveDir</span> <span style=color:#50fa7b>Directories=</span><span style=color:#f1fa8c>&#34;$(Root)\scratch\build&#34;</span> <span style=color:#50fa7b>ContinueOnError=</span><span style=color:#f1fa8c>&#34;true&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;RemoveDir</span> <span style=color:#50fa7b>Directories=</span><span style=color:#f1fa8c>&#34;$(Root)\scratch\package&#34;</span> <span style=color:#50fa7b>ContinueOnError=</span><span style=color:#f1fa8c>&#34;true&#34;</span> <span style=color:#ff79c6>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>&lt;/Target&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#6272a4>&lt;!-- lots of lines deleted--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;/Project&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>What&rsquo;s so great about <a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a>&rsquo;s XML support? No fiddling
around with namespaces, the element tree can be walked using the <code>.</code>
(aka the property dereferencing operator). So to get all
<a href="http://msdn.microsoft.com/en-us/library/ms171462(v=VS.100).aspx" title="MSBuild Targets"><code>Target</code></a> elements from the <a href="http://msdn.microsoft.com/en-us/library/ms171452(v=vs.90).aspx" title="MSBuild Overview">MSBuild</a> file you can use:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span> = [xml](<span style=color:#8be9fd;font-style:italic>Get-Content</span> openwrap.proj)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span>.Project.Target
</span></span></code></pre></td></tr></table></div></div><p>Using <code>Get-Member</code> you see that the <code>Target</code> objects have a <code>Name</code>
property.</p><p><img src=ShowMSBuildTargetName.png alt="Viewing the Name property"></p><p>One obvious thing to try would be</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span> = [xml](<span style=color:#8be9fd;font-style:italic>Get-Content</span> openwrap.proj)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span>.Project.Target.Name
</span></span></code></pre></td></tr></table></div></div><p>But that gives no output, this is caused by the fact that <code>Name</code> is an
attribute. Using <code>Select-Object</code> however works perfectly.
The total script becomes:</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ps1 data-lang=ps1><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span> = [xml](<span style=color:#8be9fd;font-style:italic>Get-Content</span> openwrap.proj)
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>$build</span>.Project.Target| <span style=color:#8be9fd;font-style:italic>Select-Object</span> Name | <span style=color:#8be9fd;font-style:italic>Sort-Object</span> Name
</span></span></code></pre></td></tr></table></div></div><p>This could be put on 1 line to uphold the slogan,
<a href=http://blogs.msdn.com/b/powershell/ title="Windows PowerShell Blog">&ldquo;Automating the world one-liner at a time&mldr;&rdquo;</a> but I find this
to be a little more readable.</p><p>This script took me 5 minutes to write and has already payed itself
back dozens of times when I need to find the name of the target that I
wish to run. That&rsquo;s all for now, next time will take a look at how you
can get an overview of your code-base using a few simple
<a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419 title="Scripting with Windows PowerShell">PowerShell</a> commands.</p><h5 id=references>References</h5><ul><li><a href=http://technet.microsoft.com/en-us/scriptcenter/dd742419>Scripting with Windows PowerShell</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms171452(v=vs.90).aspx">MSBuild Overview</a></li><li><a href=http://technet.microsoft.com/en-us/library/dd315244.aspx>PowerShell ISE</a></li><li><a href="http://msdn.microsoft.com/en-us/library/ms171462(v=VS.100).aspx">MSBuild Targets</a></li><li><a href=http://www.openwrap.org/>OpenWrap</a></li><li><a href=http://blogs.msdn.com/b/powershell/>Windows PowerShell Blog</a></li></ul></section><div class=post-tags></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/basbossink/ title=GitHub><i data-feather=github></i></a><a class=soc href=https://twitter.com/basbossink/ title=Twitter><i data-feather=twitter></i></a></div><div class=footer-info>2022 © Bas Bossink | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>